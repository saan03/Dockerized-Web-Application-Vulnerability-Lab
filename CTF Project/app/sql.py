from flask import Blueprint, render_template, request, render_template_string
import sqlite3

sql_app = Blueprint('sql', __name__)

@sql_app.route('/')
def index():
    return render_template('sql.html')

@sql_app.route('/search', methods=['GET'])
def search():
    query = request.args.get('query')
    conn = sqlite3.connect(':memory:')
    cursor = conn.cursor()
    cursor.execute('CREATE TABLE challenges (id INTEGER PRIMARY KEY, question TEXT)')
    cursor.execute('INSERT INTO challenges (question) VALUES ("What is the capital of France?"), ("Which planet is known as the Red Planet?")')
    cursor.execute(f"SELECT * FROM challenges WHERE question LIKE '%{query}%'")
    results = cursor.fetchall()
    conn.close()
    return render_template_string('''
    <h1>Search Results</h1>
    <ul>
    {% for row in results %}
        <li>{{ row[1] }}</li>
    {% endfor %}
    </ul>
    ''', results=results)